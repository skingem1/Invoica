generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// Invoice status enum representing the lifecycle states
enum InvoiceStatus {
  PENDING
  SETTLED
  PROCESSING
  COMPLETED
}

/// Invoice model representing a payment invoice in the system
model Invoice {
  /// Unique identifier
  id              String        @id @default(uuid())
  /// Sequential invoice number generated via PostgreSQL sequence
  invoiceNumber   Int           @unique
  /// Current status of the invoice
  status          InvoiceStatus @default(PENDING)
  /// Invoice amount
  amount          Decimal       @db.Decimal(19, 4)
  /// Currency code (e.g., USD, EUR)
  currency        String        @default("USD")
  /// Customer email address
  customerEmail   String
  /// Customer name
  customerName    String
  /// Payment details stored as JSON (e.g., payment method, transaction ID)
  paymentDetails  Json?
  /// Timestamp when invoice was settled
  settledAt       DateTime?
  /// Timestamp when invoice processing was completed
  completedAt     DateTime?
  /// Timestamp when invoice was created
  createdAt       DateTime      @default(now())
  /// Timestamp when invoice was last updated
  updatedAt       DateTime      @updatedAt

  @@index([status])
  @@index([customerEmail])
  @@index([invoiceNumber])
}
